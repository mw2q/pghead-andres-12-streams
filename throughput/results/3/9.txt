BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%indian%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |    sum_profit    
---------------------------+--------+------------------
 ALGERIA                   |   1998 | 264562363.971592
 ALGERIA                   |   1997 |  464714230.18577
 ALGERIA                   |   1996 | 455923514.211092
 ALGERIA                   |   1995 | 467627316.253055
 ALGERIA                   |   1994 | 455377632.224334
 ALGERIA                   |   1993 | 462291302.479558
 ALGERIA                   |   1992 | 462602744.131554
 ARGENTINA                 |   1998 | 270865109.309088
 ARGENTINA                 |   1997 | 469415778.790947
 ARGENTINA                 |   1996 | 468537051.004731
 ARGENTINA                 |   1995 | 464076414.764848
 ARGENTINA                 |   1994 | 465087638.716808
 ARGENTINA                 |   1993 | 458515236.953983
 ARGENTINA                 |   1992 | 457071087.945214
 BRAZIL                    |   1998 | 279120548.821146
 BRAZIL                    |   1997 |  464803440.97666
 BRAZIL                    |   1996 | 469882967.236559
 BRAZIL                    |   1995 | 462448199.609396
 BRAZIL                    |   1994 | 466284757.585359
 BRAZIL                    |   1993 | 465251075.820889
 BRAZIL                    |   1992 | 475700818.611803
 CANADA                    |   1998 | 275023028.133311
 CANADA                    |   1997 | 483322915.121757
 CANADA                    |   1996 |  484995212.57021
 CANADA                    |   1995 | 485089011.575796
 CANADA                    |   1994 | 485398154.975867
 CANADA                    |   1993 | 488059819.109635
 CANADA                    |   1992 | 474695527.277883
 CHINA                     |   1998 | 272877847.383589
 CHINA                     |   1997 | 463386698.128407
 CHINA                     |   1996 | 465534859.160839
 CHINA                     |   1995 | 464104038.238992
 CHINA                     |   1994 | 462450382.588583
 CHINA                     |   1993 | 466926128.517859
 CHINA                     |   1992 |  463012823.46964
 EGYPT                     |   1998 | 269463229.415412
 EGYPT                     |   1997 | 462530179.036331
 EGYPT                     |   1996 |   466281841.6674
 EGYPT                     |   1995 |  465608052.14719
 EGYPT                     |   1994 | 455263159.890123
 EGYPT                     |   1993 | 476073893.498975
 EGYPT                     |   1992 | 466987505.772121
 ETHIOPIA                  |   1998 | 272990920.686447
 ETHIOPIA                  |   1997 |  463001365.64722
 ETHIOPIA                  |   1996 |  451578098.30473
 ETHIOPIA                  |   1995 | 465201917.417622
 ETHIOPIA                  |   1994 | 462639039.515593
 ETHIOPIA                  |   1993 | 458161307.028463
 ETHIOPIA                  |   1992 |  464262505.77285
 FRANCE                    |   1998 | 268480395.882469
 FRANCE                    |   1997 | 463305495.568753
 FRANCE                    |   1996 | 470823779.002381
 FRANCE                    |   1995 | 466489900.462637
 FRANCE                    |   1994 | 466869841.634824
 FRANCE                    |   1993 | 468521769.408902
 FRANCE                    |   1992 | 463695171.012478
 GERMANY                   |   1998 | 281705808.538853
 GERMANY                   |   1997 | 470457225.498295
 GERMANY                   |   1996 | 478841531.077712
 GERMANY                   |   1995 | 469037473.814629
 GERMANY                   |   1994 | 475005879.031254
 GERMANY                   |   1993 | 476541063.809344
 GERMANY                   |   1992 | 480953628.527071
 INDIA                     |   1998 | 276291269.508585
 INDIA                     |   1997 | 473009158.305474
 INDIA                     |   1996 | 471729452.825891
 INDIA                     |   1995 | 476803440.688496
 INDIA                     |   1994 | 475855039.992805
 INDIA                     |   1993 | 469349402.589117
 INDIA                     |   1992 | 469090805.696282
 INDONESIA                 |   1998 | 273192281.049983
 INDONESIA                 |   1997 | 454722849.437353
 INDONESIA                 |   1996 | 467066929.909996
 INDONESIA                 |   1995 | 466839232.103935
 INDONESIA                 |   1994 | 460663456.381221
 INDONESIA                 |   1993 | 472170184.198529
 INDONESIA                 |   1992 | 466462088.101236
 IRAN                      |   1998 | 271993576.290484
 IRAN                      |   1997 | 457338060.432636
 IRAN                      |   1996 | 458834794.631142
 IRAN                      |   1995 | 464212035.937838
 IRAN                      |   1994 | 462623985.806996
 IRAN                      |   1993 |  453587155.12791
 IRAN                      |   1992 | 454276242.502644
 IRAQ                      |   1998 | 278461866.171621
 IRAQ                      |   1997 |   474459455.6316
 IRAQ                      |   1996 | 467606774.722997
 IRAQ                      |   1995 | 469031720.513618
 IRAQ                      |   1994 | 475396014.139146
 IRAQ                      |   1993 | 466417230.275248
 IRAQ                      |   1992 | 468689678.249551
 JAPAN                     |   1998 | 267789674.421166
 JAPAN                     |   1997 | 463805807.080685
 JAPAN                     |   1996 | 459913372.377598
 JAPAN                     |   1995 | 467782044.636982
 JAPAN                     |   1994 | 462562932.087553
 JAPAN                     |   1993 | 466538203.434049
 JAPAN                     |   1992 | 465737381.258132
 JORDAN                    |   1998 | 264222090.210338
 JORDAN                    |   1997 | 457087346.190475
 JORDAN                    |   1996 | 457851320.282562
 JORDAN                    |   1995 | 456797096.480292
 JORDAN                    |   1994 | 456054633.266317
 JORDAN                    |   1993 | 453645295.778437
 JORDAN                    |   1992 |  460416364.50464
 KENYA                     |   1998 | 277641197.715519
 KENYA                     |   1997 |  473400034.96331
 KENYA                     |   1996 | 472143226.629083
 KENYA                     |   1995 | 469232617.587566
 KENYA                     |   1994 | 466122829.858671
 KENYA                     |   1993 | 463282186.197493
 KENYA                     |   1992 | 466093553.174341
 MOROCCO                   |   1998 | 275823288.129676
 MOROCCO                   |   1997 | 467080801.830771
 MOROCCO                   |   1996 | 469263804.934082
 MOROCCO                   |   1995 | 467400299.510009
 MOROCCO                   |   1994 | 469084415.539834
 MOROCCO                   |   1993 | 480368182.537567
 MOROCCO                   |   1992 | 462795562.325755
 MOZAMBIQUE                |   1998 | 273741692.520286
 MOZAMBIQUE                |   1997 | 460629858.395203
 MOZAMBIQUE                |   1996 | 464082320.576383
 MOZAMBIQUE                |   1995 | 464111192.410166
 MOZAMBIQUE                |   1994 | 459829929.629952
 MOZAMBIQUE                |   1993 | 459997683.887493
 MOZAMBIQUE                |   1992 | 462236138.520806
 PERU                      |   1998 | 276618716.787298
 PERU                      |   1997 | 475922986.622716
 PERU                      |   1996 | 465866057.970737
 PERU                      |   1995 |  468330139.89978
 PERU                      |   1994 | 460898954.804885
 PERU                      |   1993 | 472522978.464365
 PERU                      |   1992 | 474004116.328636
 ROMANIA                   |   1998 | 276008635.348858
 ROMANIA                   |   1997 | 465473956.438912
 ROMANIA                   |   1996 | 457780776.841738
 ROMANIA                   |   1995 | 468682862.144589
 ROMANIA                   |   1994 | 468537096.412581
 ROMANIA                   |   1993 |  465407009.00167
 ROMANIA                   |   1992 | 461852039.312292
 RUSSIA                    |   1998 | 284166117.401174
 RUSSIA                    |   1997 |  473093910.10487
 RUSSIA                    |   1996 | 484515258.783401
 RUSSIA                    |   1995 | 467647604.253253
 RUSSIA                    |   1994 | 476572127.473526
 RUSSIA                    |   1993 | 469935736.767009
 RUSSIA                    |   1992 | 470044101.310846
 SAUDI ARABIA              |   1998 | 273215295.321536
 SAUDI ARABIA              |   1997 |  466303095.47869
 SAUDI ARABIA              |   1996 | 470593216.940136
 SAUDI ARABIA              |   1995 | 467431500.891047
 SAUDI ARABIA              |   1994 | 469568402.723329
 SAUDI ARABIA              |   1993 | 469704156.188021
 SAUDI ARABIA              |   1992 | 469844674.592875
 UNITED KINGDOM            |   1998 | 276787086.641035
 UNITED KINGDOM            |   1997 | 467816918.538363
 UNITED KINGDOM            |   1996 | 475670576.879928
 UNITED KINGDOM            |   1995 | 471726802.570917
 UNITED KINGDOM            |   1994 |  465112172.59098
 UNITED KINGDOM            |   1993 | 476585264.613299
 UNITED KINGDOM            |   1992 | 458979726.856652
 UNITED STATES             |   1998 | 274630513.202392
 UNITED STATES             |   1997 | 467237996.799379
 UNITED STATES             |   1996 | 470214531.673949
 UNITED STATES             |   1995 | 464045251.257836
 UNITED STATES             |   1994 | 469707120.134525
 UNITED STATES             |   1993 | 464644871.959672
 UNITED STATES             |   1992 | 467420223.993534
 VIETNAM                   |   1998 |    266342120.126
 VIETNAM                   |   1997 | 458648174.963154
 VIETNAM                   |   1996 | 463088401.364787
 VIETNAM                   |   1995 | 458718893.771435
 VIETNAM                   |   1994 | 465212202.501419
 VIETNAM                   |   1993 | 461599189.186347
 VIETNAM                   |   1992 | 457424644.200094
(175 rows)

COMMIT;
COMMIT
